---
import Layout from '../layouts/Layout.astro';
import Logo from '../components/Logo.astro';
import Quiz from '../components/Quiz.astro';
import CartDrawer from '../components/CartDrawer.astro';
import AddToCart from '../components/AddToCart.astro';
---

<Layout title="SESSR | Premium Cellular Longevity & Bio-tech Skincare">
	<div class="noise-overlay"></div>

    <nav>
        <div class="logo">
            <Logo height="50px" />
        </div>
        <ul class="nav-links">
            <li><a href="#science">SCIENCE</a></li>
            <li><a href="#shop">SHOP</a></li>
            <li><a href="#genome">THE GENOME</a></li>
        </ul>
        <div class="nav-meta">
            <button id="cart-trigger" class="cart-btn">CART <span id="header-cart-count">(0)</span></button>
        </div>
    </nav>

    <main>
        <section class="hero" id="home">
            <div class="hero-content">
                <span class="eyebrow">BIO-TECH INNOVATION</span>
                <h1>THE FUTURE OF SKIN,<br><span class="italic">PRESERVED.</span></h1>
                <p>Clinically perfected longevity through advanced genomic science and EXO-TECH™ delivery systems.</p>
                <div class="hero-actions">
                    <button class="cta-button primary">SHOP THE COLLECTION</button>
                    <button class="cta-button secondary">THE SCIENCE</button>
                </div>
            </div>
            <div class="hero-visual">
                <div class="visual-container">
                    <div class="droplet-container">
                        <div class="droplet"></div>
                        <div class="droplet-glow"></div>
                    </div>
                </div>
            </div>
            <div class="scroll-indicator">
                <span>SCROLL TO EXPLORE</span>
                <div class="line"></div>
            </div>
        </section>

        <section class="science-bridge" id="science">
            <div class="section-header">
                <span class="eyebrow">THE CORE TECHNOLOGY</span>
                <h2>EXO-TECH™ DELIVERY</h2>
            </div>
            <div class="science-grid">
                <div class="science-content">
                    <p>Our proprietary exosome-based delivery system increases ingredient absorption by 300%. Unlike
                        traditional skincare that sits on the surface, EXO-TECH™ mimics the skin's natural communication
                        vesicles.</p>
                    <ul class="science-bullets">
                        <li>Deep Cellular Repair</li>
                        <li>SIRT1 Gene Activation</li>
                        <li>Mitochondrial Support</li>
                    </ul>
                </div>
                <div class="science-visual">
                    <div class="exosome-diagram">
                        <div class="core"></div>
                        <div class="ring"></div>
                        <div class="rays"></div>
                    </div>
                </div>
            </div>
        </section>

        <section class="collection" id="shop">
            <div class="section-header center">
                <span class="eyebrow">THE COLLECTION</span>
                <h2>FOUNDATIONAL REPAIR</h2>
            </div>
            <div class="product-grid">
                <!-- Catalyst Serum -->
                <div class="product-card">
                    <div class="product-image">
                        <div class="bottle amber"></div>
                    </div>
                    <div class="product-info">
                        <span class="tag">BEST SELLER</span>
                        <h3>THE CATALYST</h3>
                        <p>Exosome-encapsulated peptide complex for 24-hour cellular repair.</p>
                        <div class="product-footer">
                            <span class="price">$320.00</span>
                            <AddToCart 
                                id="catalyst-serum" 
                                name="THE CATALYST" 
                                price={320} 
                                image="/assets/SERUM_amber.png"
                            />
                        </div>
                    </div>
                </div>

                <!-- Blue Light Defense -->
                <div class="product-card">
                    <div class="product-image">
                        <div class="bottle chrome"></div>
                    </div>
                    <div class="product-info">
                        <span class="tag">PROTECT</span>
                        <h3>BLUE LIGHT DEFENSE</h3>
                        <p>Digital shield neutralizing oxidative stress from high-energy visible light.</p>
                        <div class="product-footer">
                            <span class="price">$180.00</span>
                            <AddToCart 
                                id="blue-light-defense" 
                                name="BLUE LIGHT DEFENSE" 
                                price={180} 
                                image="/assets/CREAM_chrome.png"
                            />
                        </div>
                    </div>
                </div>

                <!-- Circadian Night Oil -->
                <div class="product-card">
                    <div class="product-image">
                        <div class="bottle frosted"></div>
                    </div>
                    <div class="product-info">
                        <span class="tag">REPAIR</span>
                        <h3>CIRCADIAN NIGHT OIL</h3>
                        <p>Synchronize repair cycles with melatonin derivatives and bio-lipids.</p>
                        <div class="product-footer">
                            <span class="price">$240.00</span>
                            <AddToCart 
                                id="circadian-night-oil" 
                                name="CIRCADIAN NIGHT OIL" 
                                price={240} 
                                image="/assets/OIL_frosted.png"
                            />
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="genome-quiz">
            <div class="section-header center">
                <span class="eyebrow">DIAGNOSTIC ANALYSIS</span>
                <h2>THE SKIN GENOME</h2>
                <p style="color: var(--secondary-color); max-width: 600px; margin: 0 auto 4rem;">Identify the precise cellular needs of your skin with our proprietary diagnostic algorithm.</p>
            </div>
            <Quiz />
        </section>
    </main>

    <footer>
        <div class="footer-grid">
            <div class="footer-brand">
                <div class="logo">
                    <Logo height="50px" />
                </div>
                <p>The Future of Skin, Preserved.</p>
            </div>
            <div class="footer-links">
                <div class="link-group">
                    <h4>SHOP</h4>
                    <a href="#">Serums</a>
                    <a href="#">Moisturizers</a>
                    <a href="#">Kits</a>
                </div>
                <div class="link-group">
                    <h4>ABOUT</h4>
                    <a href="#">Our Story</a>
                    <a href="#">Clinical Trials</a>
                    <a href="#">Careers</a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 SESSR BIOTECH. DEFINING CELLULAR LONGEVITY.</p>
        </div>
    </footer>
    <CartDrawer />
</Layout>

<script>
    import { cartItems, toggleCart } from '../stores/cartStore';

    const cartTrigger = document.getElementById('cart-trigger');
    const headerCount = document.getElementById('header-cart-count');

    cartTrigger?.addEventListener('click', toggleCart);

    cartItems.subscribe(items => {
        const count = Object.values(items).reduce((acc, item) => acc + item.quantity, 0);
        if (headerCount) {
            headerCount.textContent = `(${count})`;
        }
    });
</script>
